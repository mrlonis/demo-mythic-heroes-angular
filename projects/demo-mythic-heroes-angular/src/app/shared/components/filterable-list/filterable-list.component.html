<div class="filterable-list-container">
  <div>
    <h2>{{ pageTitle }} ({{ data.total }})</h2>
    <div id="search-form" layout layout-align="center" layout-padding>
      <ng-container *ngIf="filterStyle === 'casual' && filters !== null">
        <div class="form-field-container inline" *ngFor="let filter of filters">
          <label class="form-field-label"
            ><h5 class="filtertext">{{ filter.name }}</h5></label
          >
          <mat-form-field appearance="outline" *ngIf="filter.type === 'text'">
            <input matInput [ngModel]="getstring(filter.key)" (ngModelChange)="setfilter(filter, $event)" />
          </mat-form-field>
          <mat-form-field appearance="outline" *ngIf="filter.type === 'dropdown'">
            <mat-select placeholder="All" [ngModel]="getstring(filter.key)" (ngModelChange)="setfilter(filter, $event)">
              <mat-option></mat-option>
              <mat-option *ngFor="let group of filter.options | keyvalue" [value]="group.value">
                {{ group.key }}
              </mat-option>
            </mat-select>
          </mat-form-field>
          <mrlonis-relative-date-picker
            *ngIf="filter.type === 'relativedate'"
            [defaultCreationDate]="getreldate(filter.key)?.option ?? ''"
            [defaultDateRange]="getreldate(filter.key)?.range ?? null"
            (datesSelected)="setfilter(filter, $event)"
          ></mrlonis-relative-date-picker>
        </div>
      </ng-container>
      <div class="form-field-container inline">
        <mat-form-field appearance="outline">
          <input
            matInput
            placeholder="Search"
            #search
            (keyup)="searchEntries($event)"
            (keyup.enter)="searchEntriesUrgent($event)"
            name="search"
          />
          <mat-icon matSuffix>search</mat-icon>
        </mat-form-field>
      </div>
      <mat-button-toggle
        [checked]="filtering"
        *ngIf="filters !== null && filterStyle === 'explicit'"
        (change)="setfiltering($event.source.checked)"
        class="mat-icon-toggle"
      >
        <mat-icon class="small-mat-icon">filter_alt</mat-icon>
      </mat-button-toggle>
      <button *ngIf="this.data.appropriateModal !== null" mat-flat-button color="accent" (click)="openDialog()">
        + {{ addModalText }}
      </button>
    </div>
  </div>
  <div class="field-grouping" *ngIf="filtering && filters !== null">
    <div class="form-field-container" *ngFor="let filter of filters">
      <label class="form-field-label"
        ><h5 class="filtertext">{{ filter.name }}</h5></label
      >
      <mat-form-field appearance="outline" *ngIf="filter.type === 'text'">
        <input matInput [ngModel]="getstring(filter.key)" (ngModelChange)="setfilter(filter, $event)" />
      </mat-form-field>
      <mat-form-field appearance="outline" *ngIf="filter.type === 'dropdown'">
        <mat-select placeholder="All" [ngModel]="getstring(filter.key)" (ngModelChange)="setfilter(filter, $event)">
          <mat-option></mat-option>
          <mat-option *ngFor="let group of filter.options | keyvalue" [value]="group.value">
            {{ group.key }}
          </mat-option>
        </mat-select>
      </mat-form-field>
      <mrlonis-relative-date-picker
        *ngIf="filter.type === 'relativedate'"
        [defaultCreationDate]="getreldate(filter.key)?.option ?? ''"
        [defaultDateRange]="getreldate(filter.key)?.range ?? null"
        (datesSelected)="setfilter(filter, $event)"
      ></mrlonis-relative-date-picker>
    </div>
  </div>
  <mrlonis-simple-list
    [data]="data"
    (contentRefresh)="contentRefresh.emit()"
    [richColumnList]="richColumnQuery.toArray()"
    [richRowList]="richRowQuery.toArray()"
    [additionalRows]="additionalRows"
  ></mrlonis-simple-list>
</div>
